# Captura de Datos y Validaciones en Formularios

## 1. Captura B√°sica de Datos

Para capturar datos de un formulario en JavaScript, podemos utilizar diferentes m√©todos. Aqu√≠ est√°n los m√°s comunes:

### 1.1 Usando el evento submit

```javascript
const formulario = document.querySelector('#miFormulario');

formulario.addEventListener('submit', function(e) {
    e.preventDefault(); // Evita que el formulario se env√≠e autom√°ticamente
    
    // Captura de datos
    const nombre = document.querySelector('#nombre').value;
    const email = document.querySelector('#email').value;
    
    console.log('Nombre:', nombre);
    console.log('Email:', email);
});
```

### 1.2 FormData - Explicaci√≥n Sencilla

FormData es una herramienta que nos ayuda a trabajar f√°cilmente con los datos de un formulario. Veamos un ejemplo simple:

```html
<!-- Primero, creamos nuestro formulario HTML -->
<form id="formularioContacto">
    <div>
        <label>Nombre:</label>
        <input type="text" name="nombre">
    </div>
    
    <div>
        <label>Email:</label>
        <input type="email" name="email">
    </div>
    
    <div>
        <label>Mensaje:</label>
        <textarea name="mensaje"></textarea>
    </div>
    
    <button type="submit">Enviar</button>
</form>
```

```javascript
// Obtenemos el formulario
const formulario = document.getElementById('formularioContacto');

// Cuando el formulario se env√≠a
formulario.addEventListener('submit', function(evento) {
    // Evitamos que la p√°gina se recargue
    evento.preventDefault();
    
    // Creamos FormData con this (que es el formulario)
    const formData = new FormData(this);
    
    // üëâ As√≠ de f√°cil podemos obtener los valores:
    const nombre = formData.get('nombre');    // Obtiene el valor del campo 'nombre'
    const email = formData.get('email');      // Obtiene el valor del campo 'email'
    const mensaje = formData.get('mensaje');  // Obtiene el valor del campo 'mensaje'
    
    // üëâ Tambi√©n podemos agregar datos nuevos:
    formData.append('fecha', new Date().toISOString());
    
    // üëâ O modificar datos existentes:
    formData.set('nombre', nombre.toUpperCase());  // Convierte el nombre a may√∫sculas
    
    // Mostramos los datos en consola
    console.log({
        nombre: formData.get('nombre'),
        email: formData.get('email'),
        mensaje: formData.get('mensaje'),
        fecha: formData.get('fecha')
    });
    
    // üëâ Enviar los datos al servidor es muy f√°cil:
    fetch('/api/contacto', {
        method: 'POST',
        body: formData  // FormData se env√≠a directamente
    })
    .then(respuesta => respuesta.json())
    .then(datos => {
        alert('¬°Mensaje enviado con √©xito!');
    })
    .catch(error => {
        alert('Hubo un error al enviar el mensaje');
    });
});
```

#### üîë Puntos Importantes:

1. `new FormData(this)` crea autom√°ticamente un objeto con todos los campos del formulario
2. `formData.get('nombreCampo')` obtiene el valor de un campo
3. `formData.append('nuevoCampo', valor)` agrega un nuevo campo
4. `formData.set('campo', nuevoValor)` modifica un campo existente

#### üí° Ventajas de usar FormData:
- No necesitas obtener cada campo por separado
- Funciona autom√°ticamente con cualquier tipo de campo (texto, archivos, etc.)
- Es muy f√°cil de enviar al servidor
- No necesitas convertir nada a JSON

#### ‚ö†Ô∏è Recordatorios:
- Los campos del formulario DEBEN tener el atributo `name`
- `this` dentro del evento submit se refiere al formulario
- Siempre usa `preventDefault()` para evitar que la p√°gina se recargue

## 2. Validaciones B√°sicas

Las validaciones son fundamentales para asegurar que los datos ingresados sean correctos. Aqu√≠ hay algunos ejemplos:

### 2.1 Validaci√≥n de Campo Requerido

```javascript
function validarCampoRequerido(valor) {
    if (!valor || valor.trim() === '') {
        return 'Este campo es obligatorio';
    }
    return '';
}
```

### 2.2 Validaci√≥n de Email

```javascript
function validarEmail(email) {
    const regex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
    if (!regex.test(email)) {
        return 'Por favor, ingrese un email v√°lido';
    }
    return '';
}
```

### 2.3 Validaci√≥n de Longitud

```javascript
function validarLongitud(valor, min, max) {
    if (valor.length < min) {
        return `El campo debe tener al menos ${min} caracteres`;
    }
    if (valor.length > max) {
        return `El campo no puede tener m√°s de ${max} caracteres`;
    }
    return '';
}
```

## 3. Ejemplo Completo

Aqu√≠ tienes un ejemplo completo que incluye HTML y JavaScript:

```html
<!DOCTYPE html>
<html>
<head>
    <title>Formulario con Validaciones</title>
    <style>
        .error {
            color: red;
            font-size: 0.8em;
        }
        .campo-error {
            border: 1px solid red;
        }
    </style>
</head>
<body>
    <form id="miFormulario">
        <div>
            <label for="nombre">Nombre:</label>
            <input type="text" id="nombre" name="nombre">
            <span class="error" id="nombreError"></span>
        </div>
        
        <div>
            <label for="email">Email:</label>
            <input type="email" id="email" name="email">
            <span class="error" id="emailError"></span>
        </div>
        
        <button type="submit">Enviar</button>
    </form>

    <script>
        const formulario = document.querySelector('#miFormulario');
        
        formulario.addEventListener('submit', function(e) {
            e.preventDefault();
            let hayErrores = false;
            
            // Validar nombre
            const nombre = document.querySelector('#nombre');
            const errorNombre = validarCampoRequerido(nombre.value);
            if (errorNombre) {
                document.querySelector('#nombreError').textContent = errorNombre;
                nombre.classList.add('campo-error');
                hayErrores = true;
            } else {
                document.querySelector('#nombreError').textContent = '';
                nombre.classList.remove('campo-error');
            }
            
            // Validar email
            const email = document.querySelector('#email');
            let errorEmail = validarCampoRequerido(email.value);
            if (!errorEmail) {
                errorEmail = validarEmail(email.value);
            }
            if (errorEmail) {
                document.querySelector('#emailError').textContent = errorEmail;
                email.classList.add('campo-error');
                hayErrores = true;
            } else {
                document.querySelector('#emailError').textContent = '';
                email.classList.remove('campo-error');
            }
            
            // Si no hay errores, procesar el formulario
            if (!hayErrores) {
                console.log('Formulario v√°lido, procesando datos...');
                // Aqu√≠ puedes enviar los datos al servidor
            }
        });
    </script>
</body>
</html>
```

## 4. Mejores Pr√°cticas

1. **Validaci√≥n en Tiempo Real**: Considera validar los campos mientras el usuario escribe usando el evento `input`.
2. **Feedback Visual**: Proporciona retroalimentaci√≥n visual clara sobre errores y √©xitos.
3. **Mensajes Claros**: Usa mensajes de error espec√≠ficos y comprensibles.
4. **Accesibilidad**: Aseg√∫rate de que tus formularios sean accesibles usando atributos ARIA.
5. **Sanitizaci√≥n**: Siempre limpia y valida los datos tanto en el cliente como en el servidor.

## 5. Validaciones Adicionales Comunes

### 5.1 Validaci√≥n de N√∫meros

```javascript
function validarNumero(valor, min, max) {
    const numero = parseFloat(valor);
    if (isNaN(numero)) {
        return 'Por favor, ingrese un n√∫mero v√°lido';
    }
    if (numero < min || numero > max) {
        return `El n√∫mero debe estar entre ${min} y ${max}`;
    }
    return '';
}
```

### 5.2 Validaci√≥n de Contrase√±a

```javascript
function validarPassword(password) {
    // Al menos 8 caracteres, una may√∫scula, una min√∫scula y un n√∫mero
    const regex = /^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{8,}$/;
    if (!regex.test(password)) {
        return 'La contrase√±a debe tener al menos 8 caracteres, una may√∫scula, una min√∫scula y un n√∫mero';
    }
    return '';
}
```

### 5.3 Validaci√≥n de Fecha

```javascript
function validarFecha(fecha) {
    const fechaObj = new Date(fecha);
    if (isNaN(fechaObj.getTime())) {
        return 'Por favor, ingrese una fecha v√°lida';
    }
    return '';
}
```

Recuerda que estas validaciones son solo el primer paso. En una aplicaci√≥n real, siempre debes validar los datos tambi√©n en el servidor por razones de seguridad.
